*{box-sizing:border-box}body{font-family:system-ui,Arial,sans-serif;margin:0;color:#222}
header{padding:16px 20px;background:#f4f4f8;border-bottom:1px solid #e0e0e0}
#controls{display:flex;flex-wrap:wrap;gap:16px;padding:12px 20px;background:#fafafa;border-bottom:1px solid #eee}
.control{display:flex;align-items:center;gap:8px}
.cards{display:flex;gap:16px;flex-wrap:wrap;padding:12px 20px}
.card{background:#fff;border:1px solid #eee;border-radius:8px;padding:12px 16px;min-width:140px;box-shadow:0 1px 2px rgba(0,0,0,.04)}
.metric{font-size:28px;font-weight:700}
.label{font-size:12px;color:#666}
.charts{display:block;padding:0 20px 20px}
#table{padding:0 20px 30px}
.table-title{margin:8px 0 6px 0; font-size:16px; font-weight:600}
.scroll-hint{font-size:12px;color:#666;margin:8px 0 6px 0}
.table-wrap{overflow-x:auto; -webkit-overflow-scrolling:touch; border:1px solid #eee; background:#fff}
table{width:100%; border-collapse:collapse; min-width:2400px}
thead th{position:sticky; top:0; background:#f6f6f9; border-bottom:1px solid #ddd; padding:8px; z-index:2}
tbody td{border-bottom:1px solid #f0f0f0;padding:8px;font-size:14px; white-space:nowrap}
tbody td.col-remarks{white-space:normal; max-width:640px}
tbody tr:hover{background:#fafbff}
footer{padding:16px 20px;border-top:1px solid #eee;color:#666;font-size:13px}
input[type='text'],input[type='number']{padding:6px 8px;border:1px solid #ccc;border-radius:6px}
label{font-size:14px}
#themeToggle{ padding:6px 10px; border:1px solid #ccc; border-radius:6px; background:#fff; cursor:pointer }

/* Sticky header row & first column */
thead th:first-child, tbody td:first-child{ position: sticky; left: 0; }
thead th:first-child{ z-index: 4; }
tbody td:first-child{ z-index: 3; }

/* Light theme background for frozen first column */
body:not(.dark) thead th:first-child{ background:#f6f6f9 }
body:not(.dark) tbody td:first-child{ background:#fff; border-right:1px solid #eee }

/* Dark mode */
body.dark{ background:#0b0b0b; color:#e8e8e8 }
body.dark header{ background:#111; border-bottom-color:#222 }
body.dark #controls{ background:#0e0e0e; border-bottom-color:#222 }
body.dark .card{ background:#121212; border-color:#222; box-shadow:0 1px 2px rgba(0,0,0,.5) }
body.dark .label{ color:#bbb }
body.dark .scroll-hint{ color:#aaa }
body.dark .table-wrap{ background:#0e0e0e; border-color:#222 }
body.dark table{ background:transparent }
body.dark thead th{ background:#151515; border-bottom-color:#333; color:#e6e6e6 }
body.dark tbody td{ border-bottom-color:#1a1a1a; color:#e6e6e6 }
body.dark footer{ border-top-color:#222; color:#bbb }
body.dark input[type='text'], body.dark input[type='number']{ background:#1a1a1a; color:#e6e6e6; border-color:#333 }
body.dark #themeToggle{ background:#1a1a1a; border-color:#333; color:#e6e6e6 }
body.dark thead th:first-child{ background:#151515 }
body.dark tbody td:first-child{ background:#0e0e0e; border-right:1px solid #222 }
